<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.hcode.hoj.mapper.GroupProblemMapper">

    <resultMap id="map_ProblemList" type="top.hcode.hoj.pojo.vo.ProblemVo">
        <id column="pid" property="pid"></id>
        <result column="problem_id" property="problemId"></result>
        <result column="title" property="title"></result>
        <result column="difficulty" property="difficulty"></result>
        <result column="type" property="type"></result>
        <collection property="tags" ofType="top.hcode.hoj.pojo.entity.problem.Tag" select="getProblemTag" column="pid">
        </collection>
    </resultMap>

    <select id="getProblemList" resultMap="map_ProblemList">
        SELECT DISTINCT p.id AS pid, p.problem_id, p.title, p.difficulty, p.type
        FROM problem p
        WHERE p.auth = 1 AND p.gid = #{gid}
        ORDER BY LENGTH(p.problem_id) ASC, p.problem_id ASC
    </select>

    <select id="getProblemTag" resultType="top.hcode.hoj.pojo.entity.problem.Tag">
        select t.* from tag t,problem_tag pt where t.id = pt.tid and pt.pid = #{pid}
    </select>

    <select id="getAdminProblemList" resultType="top.hcode.hoj.pojo.entity.problem.Problem">
        SELECT p.*
        FROM problem p
        WHERE p.gid = #{gid}
        ORDER BY p.id DESC
    </select>
</mapper>
